Output folder: output/2025_01_19_foot_3views_kplanes_tv_fixed [19/11 00:32:21]
Optimizing output/2025_01_19_foot_3views_kplanes_tv_fixed [19/11 00:32:21]
Reading camera 1/3 for trainReading camera 2/3 for trainReading camera 3/3 for train [19/11 00:32:21]
Reading camera 1/100 for testReading camera 2/100 for testReading camera 3/100 for testReading camera 4/100 for testReading camera 5/100 for testReading camera 6/100 for testReading camera 7/100 for testReading camera 8/100 for testReading camera 9/100 for testReading camera 10/100 for testReading camera 11/100 for testReading camera 12/100 for testReading camera 13/100 for testReading camera 14/100 for testReading camera 15/100 for testReading camera 16/100 for testReading camera 17/100 for testReading camera 18/100 for testReading camera 19/100 for testReading camera 20/100 for testReading camera 21/100 for testReading camera 22/100 for testReading camera 23/100 for testReading camera 24/100 for testReading camera 25/100 for testReading camera 26/100 for testReading camera 27/100 for testReading camera 28/100 for testReading camera 29/100 for testReading camera 30/100 for testReading camera 31/100 for testReading camera 32/100 for testReading camera 33/100 for testReading camera 34/100 for testReading camera 35/100 for testReading camera 36/100 for testReading camera 37/100 for testReading camera 38/100 for testReading camera 39/100 for testReading camera 40/100 for testReading camera 41/100 for testReading camera 42/100 for testReading camera 43/100 for testReading camera 44/100 for testReading camera 45/100 for testReading camera 46/100 for testReading camera 47/100 for testReading camera 48/100 for testReading camera 49/100 for testReading camera 50/100 for testReading camera 51/100 for testReading camera 52/100 for testReading camera 53/100 for testReading camera 54/100 for testReading camera 55/100 for testReading camera 56/100 for testReading camera 57/100 for testReading camera 58/100 for testReading camera 59/100 for testReading camera 60/100 for testReading camera 61/100 for testReading camera 62/100 for testReading camera 63/100 for testReading camera 64/100 for testReading camera 65/100 for testReading camera 66/100 for testReading camera 67/100 for testReading camera 68/100 for testReading camera 69/100 for testReading camera 70/100 for testReading camera 71/100 for testReading camera 72/100 for testReading camera 73/100 for testReading camera 74/100 for testReading camera 75/100 for testReading camera 76/100 for testReading camera 77/100 for testReading camera 78/100 for testReading camera 79/100 for testReading camera 80/100 for testReading camera 81/100 for testReading camera 82/100 for testReading camera 83/100 for testReading camera 84/100 for testReading camera 85/100 for testReading camera 86/100 for testReading camera 87/100 for testReading camera 88/100 for testReading camera 89/100 for testReading camera 90/100 for testReading camera 91/100 for testReading camera 92/100 for testReading camera 93/100 for testReading camera 94/100 for testReading camera 95/100 for testReading camera 96/100 for testReading camera 97/100 for testReading camera 98/100 for testReading camera 99/100 for testReading camera 100/100 for test [19/11 00:32:21]
Loading Training Cameras [19/11 00:32:24]
Loading Test Cameras [19/11 00:32:26]
Initialize Gaussians with init_foot_3views.npy [19/11 00:32:26]
Initialize gaussians from 50000 estimated points [19/11 00:32:26]
Use total variation loss [19/11 00:32:26]
Train:   0%|          | 0/30000 [00:00<?, ?it/s]                                                Train:   0%|          | 0/30000 [00:10<?, ?it/s]Train:   0%|          | 0/30000 [00:11<?, ?it/s, loss=1.5e-01, pts=5.0e+04]Train:   0%|          | 10/30000 [00:11<9:11:20,  1.10s/it, loss=1.5e-01, pts=5.0e+04]Train:   0%|          | 10/30000 [00:11<9:11:20,  1.10s/it, loss=1.2e-01, pts=5.0e+04]Train:   0%|          | 20/30000 [00:11<4:00:34,  2.08it/s, loss=1.2e-01, pts=5.0e+04]Train:   0%|          | 20/30000 [00:11<4:00:34,  2.08it/s, loss=9.1e-02, pts=5.0e+04]Train:   0%|          | 30/30000 [00:11<2:21:07,  3.54it/s, loss=9.1e-02, pts=5.0e+04]Train:   0%|          | 30/30000 [00:12<2:21:07,  3.54it/s, loss=7.6e-02, pts=5.0e+04]Train:   0%|          | 40/30000 [00:12<1:33:30,  5.34it/s, loss=7.6e-02, pts=5.0e+04]Train:   0%|          | 40/30000 [00:12<1:33:30,  5.34it/s, loss=7.3e-02, pts=5.0e+04]Train:   0%|          | 50/30000 [00:12<1:06:34,  7.50it/s, loss=7.3e-02, pts=5.0e+04]Train:   0%|          | 50/30000 [00:13<1:06:34,  7.50it/s, loss=6.4e-02, pts=5.0e+04]Train:   0%|          | 60/30000 [00:13<50:51,  9.81it/s, loss=6.4e-02, pts=5.0e+04]  Train:   0%|          | 60/30000 [00:13<50:51,  9.81it/s, loss=5.7e-02, pts=5.0e+04]Train:   0%|          | 70/30000 [00:13<40:14, 12.39it/s, loss=5.7e-02, pts=5.0e+04]Train:   0%|          | 70/30000 [00:13<40:14, 12.39it/s, loss=5.1e-02, pts=5.0e+04]Train:   0%|          | 80/30000 [00:13<33:55, 14.70it/s, loss=5.1e-02, pts=5.0e+04]Train:   0%|          | 80/30000 [00:14<33:55, 14.70it/s, loss=4.5e-02, pts=5.0e+04]Train:   0%|          | 90/30000 [00:14<28:55, 17.23it/s, loss=4.5e-02, pts=5.0e+04]Train:   0%|          | 90/30000 [00:14<28:55, 17.23it/s, loss=4.0e-02, pts=5.0e+04]Train:   0%|          | 100/30000 [00:14<26:27, 18.83it/s, loss=4.0e-02, pts=5.0e+04]Train:   0%|          | 100/30000 [00:15<26:27, 18.83it/s, loss=2.8e-02, pts=5.0e+04]Train:   0%|          | 110/30000 [00:15<24:50, 20.05it/s, loss=2.8e-02, pts=5.0e+04]Train:   0%|          | 110/30000 [00:15<24:50, 20.05it/s, loss=3.1e-02, pts=5.0e+04]Train:   0%|          | 120/30000 [00:15<23:32, 21.16it/s, loss=3.1e-02, pts=5.0e+04]Train:   0%|          | 120/30000 [00:15<23:32, 21.16it/s, loss=2.1e-02, pts=5.0e+04]Train:   0%|          | 130/30000 [00:15<22:42, 21.93it/s, loss=2.1e-02, pts=5.0e+04]Train:   0%|          | 130/30000 [00:16<22:42, 21.93it/s, loss=1.9e-02, pts=5.0e+04]Train:   0%|          | 140/30000 [00:16<21:47, 22.83it/s, loss=1.9e-02, pts=5.0e+04]Train:   0%|          | 140/30000 [00:16<21:47, 22.83it/s, loss=1.6e-02, pts=5.0e+04]Train:   0%|          | 150/30000 [00:16<21:37, 23.00it/s, loss=1.6e-02, pts=5.0e+04]Train:   0%|          | 150/30000 [00:17<21:37, 23.00it/s, loss=1.4e-02, pts=5.0e+04]Train:   1%|          | 160/30000 [00:17<21:13, 23.44it/s, loss=1.4e-02, pts=5.0e+04]Train:   1%|          | 160/30000 [00:17<21:13, 23.44it/s, loss=1.3e-02, pts=5.0e+04]Train:   1%|          | 170/30000 [00:17<21:12, 23.43it/s, loss=1.3e-02, pts=5.0e+04]Train:   1%|          | 170/30000 [00:18<21:12, 23.43it/s, loss=1.2e-02, pts=5.0e+04]Train:   1%|          | 180/30000 [00:18<21:02, 23.63it/s, loss=1.2e-02, pts=5.0e+04]Train:   1%|          | 180/30000 [00:18<21:02, 23.63it/s, loss=1.1e-02, pts=5.0e+04]Train:   1%|          | 190/30000 [00:18<20:55, 23.75it/s, loss=1.1e-02, pts=5.0e+04]Train:   1%|          | 190/30000 [00:18<20:55, 23.75it/s, loss=9.7e-03, pts=5.0e+04]Train:   1%|          | 200/30000 [00:18<20:48, 23.86it/s, loss=9.7e-03, pts=5.0e+04]Train:   1%|          | 200/30000 [00:19<20:48, 23.86it/s, loss=8.9e-03, pts=5.0e+04]Train:   1%|          | 210/30000 [00:19<20:47, 23.87it/s, loss=8.9e-03, pts=5.0e+04]Train:   1%|          | 210/30000 [00:19<20:47, 23.87it/s, loss=8.8e-03, pts=5.0e+04]Train:   1%|          | 220/30000 [00:19<20:51, 23.79it/s, loss=8.8e-03, pts=5.0e+04]Train:   1%|          | 220/30000 [00:20<20:51, 23.79it/s, loss=7.8e-03, pts=5.0e+04]Train:   1%|          | 230/30000 [00:20<20:23, 24.33it/s, loss=7.8e-03, pts=5.0e+04]Train:   1%|          | 230/30000 [00:20<20:23, 24.33it/s, loss=9.0e-03, pts=5.0e+04]Train:   1%|          | 240/30000 [00:20<20:29, 24.21it/s, loss=9.0e-03, pts=5.0e+04]Train:   1%|          | 240/30000 [00:21<20:29, 24.21it/s, loss=7.3e-03, pts=5.0e+04]Train:   1%|          | 250/30000 [00:21<21:51, 22.69it/s, loss=7.3e-03, pts=5.0e+04]Train:   1%|          | 250/30000 [00:21<21:51, 22.69it/s, loss=7.1e-03, pts=5.0e+04]Train:   1%|          | 260/30000 [00:21<21:11, 23.39it/s, loss=7.1e-03, pts=5.0e+04]Train:   1%|          | 260/30000 [00:21<21:11, 23.39it/s, loss=6.5e-03, pts=5.0e+04]Train:   1%|          | 270/30000 [00:21<18:59, 26.10it/s, loss=6.5e-03, pts=5.0e+04]Train:   1%|          | 270/30000 [00:21<18:59, 26.10it/s, loss=6.2e-03, pts=5.0e+04]Train:   1%|          | 280/30000 [00:21<17:35, 28.15it/s, loss=6.2e-03, pts=5.0e+04]Train:   1%|          | 280/30000 [00:22<17:35, 28.15it/s, loss=6.5e-03, pts=5.0e+04]Train:   1%|          | 290/30000 [00:22<16:08, 30.67it/s, loss=6.5e-03, pts=5.0e+04]Train:   1%|          | 290/30000 [00:22<16:08, 30.67it/s, loss=6.3e-03, pts=5.0e+04]Train:   1%|          | 300/30000 [00:22<15:04, 32.83it/s, loss=6.3e-03, pts=5.0e+04]Train:   1%|          | 300/30000 [00:22<15:04, 32.83it/s, loss=6.7e-03, pts=5.0e+04]Train:   1%|          | 310/30000 [00:22<14:36, 33.88it/s, loss=6.7e-03, pts=5.0e+04]Train:   1%|          | 310/30000 [00:23<14:36, 33.88it/s, loss=5.5e-03, pts=5.0e+04]Train:   1%|          | 320/30000 [00:23<14:26, 34.25it/s, loss=5.5e-03, pts=5.0e+04]Train:   1%|          | 320/30000 [00:23<14:26, 34.25it/s, loss=6.8e-03, pts=5.0e+04]Train:   1%|          | 330/30000 [00:23<14:19, 34.52it/s, loss=6.8e-03, pts=5.0e+04]Train:   1%|          | 330/30000 [00:23<14:19, 34.52it/s, loss=5.7e-03, pts=5.0e+04]Train:   1%|          | 340/30000 [00:23<14:20, 34.46it/s, loss=5.7e-03, pts=5.0e+04]Train:   1%|          | 340/30000 [00:23<14:20, 34.46it/s, loss=5.5e-03, pts=5.0e+04]Train:   1%|          | 350/30000 [00:23<14:19, 34.50it/s, loss=5.5e-03, pts=5.0e+04]Train:   1%|          | 350/30000 [00:24<14:19, 34.50it/s, loss=5.0e-03, pts=5.0e+04]Train:   1%|          | 360/30000 [00:24<14:24, 34.29it/s, loss=5.0e-03, pts=5.0e+04]Train:   1%|          | 360/30000 [00:24<14:24, 34.29it/s, loss=4.9e-03, pts=5.0e+04]Train:   1%|          | 370/30000 [00:24<14:36, 33.82it/s, loss=4.9e-03, pts=5.0e+04]Train:   1%|          | 370/30000 [00:24<14:36, 33.82it/s, loss=5.3e-03, pts=5.0e+04]Train:   1%|▏         | 380/30000 [00:24<14:38, 33.70it/s, loss=5.3e-03, pts=5.0e+04]Train:   1%|▏         | 380/30000 [00:25<14:38, 33.70it/s, loss=5.4e-03, pts=5.0e+04]Train:   1%|▏         | 390/30000 [00:25<14:46, 33.40it/s, loss=5.4e-03, pts=5.0e+04]Train:   1%|▏         | 390/30000 [00:25<14:46, 33.40it/s, loss=4.8e-03, pts=5.0e+04]Train:   1%|▏         | 400/30000 [00:25<14:35, 33.80it/s, loss=4.8e-03, pts=5.0e+04]Train:   1%|▏         | 400/30000 [00:25<14:35, 33.80it/s, loss=5.1e-03, pts=5.0e+04]Train:   1%|▏         | 410/30000 [00:25<14:30, 33.99it/s, loss=5.1e-03, pts=5.0e+04]Train:   1%|▏         | 410/30000 [00:26<14:30, 33.99it/s, loss=4.6e-03, pts=5.0e+04]Train:   1%|▏         | 420/30000 [00:26<14:26, 34.14it/s, loss=4.6e-03, pts=5.0e+04]Train:   1%|▏         | 420/30000 [00:26<14:26, 34.14it/s, loss=4.9e-03, pts=5.0e+04]Train:   1%|▏         | 430/30000 [00:26<14:28, 34.04it/s, loss=4.9e-03, pts=5.0e+04]Train:   1%|▏         | 430/30000 [00:26<14:28, 34.04it/s, loss=4.3e-03, pts=5.0e+04]Train:   1%|▏         | 440/30000 [00:26<14:25, 34.14it/s, loss=4.3e-03, pts=5.0e+04]Train:   1%|▏         | 440/30000 [00:26<14:25, 34.14it/s, loss=4.9e-03, pts=5.0e+04]Train:   2%|▏         | 450/30000 [00:26<14:27, 34.06it/s, loss=4.9e-03, pts=5.0e+04]Train:   2%|▏         | 450/30000 [00:27<14:27, 34.06it/s, loss=4.2e-03, pts=5.0e+04]Train:   2%|▏         | 460/30000 [00:27<14:17, 34.46it/s, loss=4.2e-03, pts=5.0e+04]Train:   2%|▏         | 460/30000 [00:27<14:17, 34.46it/s, loss=4.8e-03, pts=5.0e+04]Train:   2%|▏         | 470/30000 [00:27<14:08, 34.81it/s, loss=4.8e-03, pts=5.0e+04]Train:   2%|▏         | 470/30000 [00:27<14:08, 34.81it/s, loss=4.7e-03, pts=5.0e+04]Train:   2%|▏         | 480/30000 [00:27<13:57, 35.23it/s, loss=4.7e-03, pts=5.0e+04]Train:   2%|▏         | 480/30000 [00:27<13:57, 35.23it/s, loss=4.1e-03, pts=5.0e+04]Train:   2%|▏         | 490/30000 [00:27<13:50, 35.53it/s, loss=4.1e-03, pts=5.0e+04]Train:   2%|▏         | 490/30000 [00:28<13:50, 35.53it/s, loss=4.9e-03, pts=5.0e+04]Train:   2%|▏         | 500/30000 [00:28<13:48, 35.61it/s, loss=4.9e-03, pts=5.0e+04]Train:   2%|▏         | 500/30000 [00:28<13:48, 35.61it/s, loss=4.6e-03, pts=5.0e+04]Train:   2%|▏         | 510/30000 [00:28<13:42, 35.85it/s, loss=4.6e-03, pts=5.0e+04]Train:   2%|▏         | 510/30000 [00:28<13:42, 35.85it/s, loss=4.5e-03, pts=5.0e+04]Train:   2%|▏         | 520/30000 [00:28<13:27, 36.50it/s, loss=4.5e-03, pts=5.0e+04]Train:   2%|▏         | 520/30000 [00:29<13:27, 36.50it/s, loss=3.9e-03, pts=5.0e+04]Train:   2%|▏         | 530/30000 [00:29<13:18, 36.89it/s, loss=3.9e-03, pts=5.0e+04]Train:   2%|▏         | 530/30000 [00:29<13:18, 36.89it/s, loss=3.8e-03, pts=5.0e+04]Train:   2%|▏         | 540/30000 [00:29<13:17, 36.93it/s, loss=3.8e-03, pts=5.0e+04]Train:   2%|▏         | 540/30000 [00:29<13:17, 36.93it/s, loss=4.6e-03, pts=5.0e+04]Train:   2%|▏         | 550/30000 [00:29<13:13, 37.14it/s, loss=4.6e-03, pts=5.0e+04]Train:   2%|▏         | 550/30000 [00:29<13:13, 37.14it/s, loss=3.7e-03, pts=5.0e+04]Train:   2%|▏         | 560/30000 [00:29<13:10, 37.25it/s, loss=3.7e-03, pts=5.0e+04]Train:   2%|▏         | 560/30000 [00:30<13:10, 37.25it/s, loss=3.9e-03, pts=5.0e+04]Train:   2%|▏         | 570/30000 [00:30<13:13, 37.09it/s, loss=3.9e-03, pts=5.0e+04]Train:   2%|▏         | 570/30000 [00:30<13:13, 37.09it/s, loss=4.7e-03, pts=5.0e+04]Train:   2%|▏         | 580/30000 [00:30<13:21, 36.69it/s, loss=4.7e-03, pts=5.0e+04]Train:   2%|▏         | 580/30000 [00:30<13:21, 36.69it/s, loss=4.6e-03, pts=5.0e+04]Train:   2%|▏         | 590/30000 [00:30<13:47, 35.53it/s, loss=4.6e-03, pts=5.0e+04][ITER 1] Evaluating: psnr3d 20.660, ssim3d 0.123, psnr2d 16.482, ssim2d 0.399 [19/11 00:32:37]
Traceback (most recent call last):
  File "/home/qyhu/Documents/r2_ours/r2_gaussian/train.py", line 416, in <module>
    training(
  File "/home/qyhu/Documents/r2_ours/r2_gaussian/train.py", line 172, in training
    gaussians.densify_and_prune(
  File "/home/qyhu/Documents/r2_ours/r2_gaussian/r2_gaussian/gaussian/gaussian_model.py", line 585, in densify_and_prune
    self.densify_and_split(grads, max_grad, densify_scale_threshold)
  File "/home/qyhu/Documents/r2_ours/r2_gaussian/r2_gaussian/gaussian/gaussian_model.py", line 535, in densify_and_split
    self.prune_points(prune_filter)
  File "/home/qyhu/Documents/r2_ours/r2_gaussian/r2_gaussian/gaussian/gaussian_model.py", line 418, in prune_points
    optimizable_tensors = self._prune_optimizer(valid_points_mask)
  File "/home/qyhu/Documents/r2_ours/r2_gaussian/r2_gaussian/gaussian/gaussian_model.py", line 399, in _prune_optimizer
    stored_state["exp_avg"] = stored_state["exp_avg"][mask]
IndexError: The shape of the mask [50933] at index 0 does not match the shape of the indexed tensor [1, 32, 64, 64] at index 0
                                                                                     
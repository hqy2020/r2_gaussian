# R2-Gaussian å¢å¼ºç‰ˆ

åŸºäºåŸå§‹R2-Gaussianï¼Œå‚è€ƒX-Gaussiançš„å¤šé«˜æ–¯ã€ä¼ªæ ‡ç­¾ã€æ·±åº¦åŠŸèƒ½å®ç°ã€‚

## ğŸ¯ æ–°å¢åŠŸèƒ½

### 1. å¤šé«˜æ–¯è®­ç»ƒ (Multi-Gaussian Training)
- ä»å¤šä¸ªè§†è§’åŒæ—¶è®­ç»ƒé«˜æ–¯æ¨¡å‹
- è‡ªåŠ¨ç”Ÿæˆé¢å¤–çš„è®­ç»ƒè§†è§’
- æå‡3Dé‡å»ºçš„å®Œæ•´æ€§å’Œä¸€è‡´æ€§

### 2. ä¼ªæ ‡ç­¾æœºåˆ¶ (Pseudo Labels)
- ä½¿ç”¨å½“å‰æ¨¡å‹é¢„æµ‹ç»“æœä½œä¸ºè®­ç»ƒæ ‡ç­¾
- å®ç°è‡ªç›‘ç£å­¦ä¹ 
- å»¶è¿Ÿå¯åŠ¨æœºåˆ¶é¿å…æ—©æœŸä¸ç¨³å®š

### 3. æ·±åº¦çº¦æŸ (Depth Constraint)
- åˆ©ç”¨æ·±åº¦ä¿¡æ¯çº¦æŸé«˜æ–¯æ¨¡å‹ç©ºé—´åˆ†å¸ƒ
- æå‡3Dé‡å»ºçš„å‡ ä½•å‡†ç¡®æ€§
- æ”¯æŒæ·±åº¦èŒƒå›´çº¦æŸ

## ğŸ”§ æŠ€æœ¯å®ç°

### æ ¸å¿ƒä¿®æ”¹æ–‡ä»¶

1. **æŸå¤±å‡½æ•°æ‰©å±•** (`r2_gaussian/utils/loss_utils.py`)
   - `loss_photometric()`: å¸¦maskçš„å…‰åº¦æŸå¤±
   - `l1_loss_mask()`: å¸¦maskçš„L1æŸå¤±
   - `depth_loss()`: æ·±åº¦ä¸€è‡´æ€§æŸå¤±
   - `pseudo_label_loss()`: ä¼ªæ ‡ç­¾æŸå¤±

2. **ç›¸æœºæ¨¡å—å¢å¼º** (`r2_gaussian/dataset/cameras.py`)
   - `PseudoCamera`ç±»: ä¼ªæ ‡ç­¾ç›¸æœºå®ç°
   - `Camera`ç±»æ‰©å±•: æ”¯æŒæ·±åº¦å‚æ•°
   - CPUè®¡ç®—é¿å…CUBLASé”™è¯¯

3. **å§¿æ€ç”Ÿæˆå·¥å…·** (`r2_gaussian/utils/pose_utils.py`)
   - `generate_random_poses_360()`: 360åº¦ç¯ç»•å§¿æ€
   - `generate_random_poses_llff()`: LLFFé£æ ¼å§¿æ€
   - `generate_random_poses_pickle()`: Pickleæ•°æ®å§¿æ€
   - `generate_uniform_poses_forview()`: å‡åŒ€åˆ†å¸ƒå§¿æ€

4. **åœºæ™¯ç±»å¢å¼º** (`r2_gaussian/dataset/__init__.py`)
   - `generate_multi_gaussian_cameras()`: ç”Ÿæˆå¤šé«˜æ–¯ç›¸æœº
   - `generate_pseudo_labels()`: ç”Ÿæˆä¼ªæ ‡ç­¾

5. **å‚æ•°é…ç½®** (`r2_gaussian/arguments/__init__.py`)
   - æ–°å¢å¤šé«˜æ–¯ã€ä¼ªæ ‡ç­¾ã€æ·±åº¦ç›¸å…³å‚æ•°
   - æ”¯æŒæƒé‡è°ƒèŠ‚å’Œé˜ˆå€¼è®¾ç½®

6. **è®­ç»ƒè„šæœ¬** (`train.py`)
   - é›†æˆå¤šé«˜æ–¯è®­ç»ƒé€»è¾‘
   - å®ç°ä¼ªæ ‡ç­¾ç”Ÿæˆå’Œä½¿ç”¨
   - æ”¯æŒæ·±åº¦çº¦æŸè®¡ç®—

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### åŸºç¡€è®­ç»ƒï¼ˆä¸å˜ï¼‰
```bash
python train.py -s data/369/chest_50_3views.pickle -m output/basic
```

### å¤šé«˜æ–¯è®­ç»ƒ
```bash
python train.py -s data/369/chest_50_3views.pickle -m output/multi --multi_gaussian
```

### ä¼ªæ ‡ç­¾è®­ç»ƒ
```bash
python train.py -s data/369/chest_50_3views.pickle -m output/pseudo --pseudo_labels
```

### æ·±åº¦çº¦æŸè®­ç»ƒ
```bash
python train.py -s data/369/chest_50_3views.pickle -m output/depth --depth_constraint
```

### ç»„åˆè®­ç»ƒ
```bash
python train.py -s data/369/chest_50_3views.pickle -m output/combined \
    --multi_gaussian --pseudo_labels --depth_constraint \
    --num_additional_views 15 \
    --multi_gaussian_weight 0.15 \
    --pseudo_label_weight 0.08 \
    --depth_loss_weight 0.12
```

## ğŸ“‹ æ–°å¢å‚æ•°

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `--multi_gaussian` | bool | False | å¯ç”¨å¤šé«˜æ–¯è®­ç»ƒ |
| `--pseudo_labels` | bool | False | å¯ç”¨ä¼ªæ ‡ç­¾è®­ç»ƒ |
| `--depth_constraint` | bool | False | å¯ç”¨æ·±åº¦çº¦æŸ |
| `--num_additional_views` | int | 10 | é¢å¤–è§†è§’æ•°é‡ |
| `--pseudo_confidence_threshold` | float | 0.8 | ä¼ªæ ‡ç­¾ç½®ä¿¡åº¦é˜ˆå€¼ |
| `--multi_gaussian_weight` | float | 0.1 | å¤šé«˜æ–¯æŸå¤±æƒé‡ |
| `--pseudo_label_weight` | float | 0.05 | ä¼ªæ ‡ç­¾æŸå¤±æƒé‡ |
| `--depth_loss_weight` | float | 0.1 | æ·±åº¦æŸå¤±æƒé‡ |

## ğŸ”„ å‘åå…¼å®¹æ€§

- âœ… å®Œå…¨å‘åå…¼å®¹åŸå§‹åŠŸèƒ½
- âœ… åŸæœ‰è®­ç»ƒå‘½ä»¤æ— éœ€ä¿®æ”¹
- âœ… æ–°åŠŸèƒ½é€šè¿‡å‚æ•°æ§åˆ¶å¯ç”¨
- âœ… ä¸å½±å“ç°æœ‰æ¨¡å‹å’Œç»“æœ

## ğŸ› ï¸ ç¯å¢ƒè¦æ±‚

- ä¸åŸå§‹R2-Gaussianç›¸åŒ
- Condaç¯å¢ƒ: `r2_gaussian_new`
- CUDA 11.6
- PyTorch 1.12.1

## ğŸ“Š æ€§èƒ½å»ºè®®

### å‚æ•°è°ƒä¼˜
- **å°æ•°æ®é›†**: `num_additional_views = 5-10`
- **å¤§æ•°æ®é›†**: `num_additional_views = 10-20`
- **å¿«é€Ÿæµ‹è¯•**: åªå¯ç”¨ `--multi_gaussian`
- **é«˜è´¨é‡è®­ç»ƒ**: ç»„åˆä½¿ç”¨æ‰€æœ‰åŠŸèƒ½
- **å†…å­˜ä¸è¶³**: å‡å°‘ `num_additional_views`

### è®­ç»ƒç­–ç•¥
1. å…ˆä½¿ç”¨åŸºç¡€åŠŸèƒ½éªŒè¯æ•°æ®
2. é€æ­¥å¯ç”¨å¤šé«˜æ–¯è®­ç»ƒ
3. åœ¨æ¨¡å‹ç¨³å®šåå¯ç”¨ä¼ªæ ‡ç­¾
4. æ ¹æ®æ•°æ®ç‰¹ç‚¹è°ƒæ•´æƒé‡å‚æ•°

## ğŸ” æŠ€æœ¯ç»†èŠ‚

### CUBLASé”™è¯¯ä¿®å¤
- æ‰€æœ‰çŸ©é˜µä¹˜æ³•æ“ä½œç§»åˆ°CPUæ‰§è¡Œ
- é¿å… `CUBLAS_STATUS_NOT_SUPPORTED` é”™è¯¯
- ä¿æŒæ•°å€¼ç²¾åº¦ä¸å˜

### å†…å­˜ä¼˜åŒ–
- é™åˆ¶åŒæ—¶å¤„ç†çš„é¢å¤–è§†è§’æ•°é‡
- ä½¿ç”¨æ¢¯åº¦æ£€æŸ¥ç‚¹å‡å°‘å†…å­˜å ç”¨
- æ”¯æŒåŠ¨æ€è°ƒæ•´batchå¤§å°

### è®­ç»ƒç¨³å®šæ€§
- ä¼ªæ ‡ç­¾å»¶è¿Ÿå¯åŠ¨æœºåˆ¶
- æ¢¯åº¦è£å‰ªé˜²æ­¢è®­ç»ƒä¸ç¨³å®š
- å­¦ä¹ ç‡è°ƒåº¦ä¼˜åŒ–

## ğŸ“ å‚è€ƒå®ç°

æœ¬å®ç°å‚è€ƒäº†X-Gaussiançš„å¤šé«˜æ–¯ã€ä¼ªæ ‡ç­¾ã€æ·±åº¦åŠŸèƒ½ï¼š
- PseudoCameraç±»è®¾è®¡
- æŸå¤±å‡½æ•°å®ç°
- è®­ç»ƒç­–ç•¥ä¼˜åŒ–
- å‚æ•°é…ç½®æ–¹æ¡ˆ

## ğŸ¤ è´¡çŒ®

åŸºäºåŸå§‹R2-Gaussiané¡¹ç›®ï¼Œåœ¨ä¿æŒæ ¸å¿ƒæ¶æ„ä¸å˜çš„å‰æä¸‹ï¼Œæ‰©å±•äº†å¤šé«˜æ–¯è®­ç»ƒèƒ½åŠ›ã€‚

## ğŸ“„ è®¸å¯è¯

ä¸åŸå§‹R2-Gaussiané¡¹ç›®ä¿æŒä¸€è‡´çš„è®¸å¯è¯ã€‚
